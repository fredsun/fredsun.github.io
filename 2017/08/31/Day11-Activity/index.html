<!DOCTYPE html>




<html class="theme-next pisces" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon_32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Android,Activity,Activity栈," />










<meta name="description" content="Activity 生命周期, 启动模式, Activity栈">
<meta name="keywords" content="Android,Activity,Activity栈">
<meta property="og:type" content="article">
<meta property="og:title" content="Day11 - Activity">
<meta property="og:url" content="http://yoursite.com/2017/08/31/Day11-Activity/index.html">
<meta property="og:site_name" content="花花世界">
<meta property="og:description" content="Activity 生命周期, 启动模式, Activity栈">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://raw.githubusercontent.com/sunxlfred/RES/master/activity_lifecycle.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sunxlfred/RES/b761a9c324ffc934e11d4132df1a18d2387e6065/Serializable%26Parcelable.png">
<meta property="og:updated_time" content="2017-10-20T06:51:02.350Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Day11 - Activity">
<meta name="twitter:description" content="Activity 生命周期, 启动模式, Activity栈">
<meta name="twitter:image" content="https://raw.githubusercontent.com/sunxlfred/RES/master/activity_lifecycle.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/08/31/Day11-Activity/"/>





  <title>Day11 - Activity | 花花世界</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4f019e7db67954cb48d8455dec751768";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">花花世界</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">fred的blog</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/31/Day11-Activity/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FredSun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars2.githubusercontent.com/u/9950351?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="花花世界">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Day11 - Activity</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-31T16:09:00+08:00">
                2017-08-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/100DaysOfAndroid/" itemprop="url" rel="index">
                    <span itemprop="name">100DaysOfAndroid</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Activity 生命周期, 启动模式, Activity栈<br><a id="more"></a></p>
<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><p><img src="https://raw.githubusercontent.com/sunxlfred/RES/master/activity_lifecycle.png" alt=""></p>
<ul>
<li>onCreate();</li>
<li>onStart(); 可见,</li>
<li>onResume(); 可操作,在前台</li>
<li>onPause();</li>
<li>onStop();</li>
<li>onDestroy();<ul>
<li>onRestart(); 返回前activity, 让他重新启动</li>
</ul>
</li>
<li><p>当Activity只执行onPause方法时（透明Activity），这时候如果App设置的targetVersion大于11则不会执行onSaveInstanceState方法</p>
<h4 id="处理广播-在onStart和onStop-onResume和onPause易触发并且可能只是暂时不能执行-被透明activity挡住"><a href="#处理广播-在onStart和onStop-onResume和onPause易触发并且可能只是暂时不能执行-被透明activity挡住" class="headerlink" title="处理广播, 在onStart和onStop, onResume和onPause易触发并且可能只是暂时不能执行(被透明activity挡住)"></a>处理广播, 在onStart和onStop, onResume和onPause易触发并且可能只是暂时不能执行(被透明activity挡住)</h4><h4 id="跳转B前操作数据库-并且B需要数据库-在onPause"><a href="#跳转B前操作数据库-并且B需要数据库-在onPause" class="headerlink" title="跳转B前操作数据库, 并且B需要数据库, 在onPause,"></a>跳转B前操作数据库, 并且B需要数据库, 在onPause,</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">onPause</div><div class="line">onCreate--B</div><div class="line">onStart--B</div><div class="line">onResume--B</div><div class="line">onStop</div></pre></td></tr></table></figure>
<p>所以得确保B没出来的时候数据加载完毕, 但是如果B是半透明的, 则不会执行onStop<br>B返回A</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">onPause -B</div><div class="line">onRestart</div><div class="line">onStart</div><div class="line">onResume</div><div class="line">onStop --B</div><div class="line">onDestroy --B</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="黑屏-按home-按任务列表生命周期"><a href="#黑屏-按home-按任务列表生命周期" class="headerlink" title="黑屏/按home/按任务列表生命周期:"></a>黑屏/按home/按任务列表生命周期:</h4>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">onPause</div><div class="line">onStop</div><div class="line">onRestart</div><div class="line">onStart</div><div class="line">onResume</div></pre></td></tr></table></figure>
<h4 id="横竖屏切换生命周期-此时开-alertDialog-Builder-格式的dialog-生命周期不影响"><a href="#横竖屏切换生命周期-此时开-alertDialog-Builder-格式的dialog-生命周期不影响" class="headerlink" title="横竖屏切换生命周期,此时开 alertDialog.Builder 格式的dialog, 生命周期不影响"></a>横竖屏切换生命周期,此时开 alertDialog.Builder 格式的dialog, 生命周期不影响</h4>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">onPause</div><div class="line">onStop</div><div class="line">onDestroy</div><div class="line">onCreate</div><div class="line">onStart</div><div class="line">onResume</div></pre></td></tr></table></figure>
<h3 id="Activity-是否运行"><a href="#Activity-是否运行" class="headerlink" title="Activity 是否运行"></a>Activity 是否运行</h3><p>(activity == null || activity.isDestroyed() || activity.isFinishing())<br>原因: isFinishing 根据 mFinished, mFinished只在<figure class="highlight plain"><figcaption><span>无法确定finish一定会执行, 且 finish 执行后, 无法保证立马走到 onDestroy</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">```</div><div class="line">public boolean isFinishing() &#123;</div><div class="line">       return mFinished;</div><div class="line">   &#125;</div></pre></td></tr></table></figure></p>
<p>根据Google源码中的Dialer应用的源码<a href="http://androidxref.com/6.0.1_r10/xref/packages/apps/Dialer/src/com/android/dialer/calllog/ClearCallLogDialog.java" target="_blank" rel="external">Link</a>, 添加 isDestroyed 判断<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPostExecute</span><span class="params">(Void result)</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> Activity activity = progressDialog.getOwnerActivity();</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (activity == <span class="keyword">null</span> || activity.isDestroyed() || activity.isFinishing()) &#123;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (progressDialog != <span class="keyword">null</span> &amp;&amp; progressDialog.isShowing()) &#123;</div><div class="line">            progressDialog.dismiss();</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<h3 id="onUserLeaveHint-和-onUserInteraction"><a href="#onUserLeaveHint-和-onUserInteraction" class="headerlink" title="onUserLeaveHint 和 onUserInteraction"></a>onUserLeaveHint 和 onUserInteraction</h3><ul>
<li>onUserLeaveHint<br>当用户的操作导致activity即将进入后台的时候, 此方法会被调用, <strong>但在来电时不被调用</strong></li>
<li>onUserInteraction<br>activity 在分发各种事件之前会调用, <strong>但启动另一个activity会被调用两次</strong>, 一次是 activity 补货到事件时, 一次是调用activity.onUserLeaveHint之前会调用onUserInteraction</li>
</ul>
<h3 id="临时状态保存-–-onSaveInstanceState-和-onRestoreInstanceState"><a href="#临时状态保存-–-onSaveInstanceState-和-onRestoreInstanceState" class="headerlink" title="临时状态保存 – onSaveInstanceState 和 onRestoreInstanceState"></a>临时状态保存 – onSaveInstanceState 和 onRestoreInstanceState</h3><p> 是用来临时存储数据, 长期的还是需要数据库</p>
<blockquote>
<p>前提是view必须有ID</p>
</blockquote>
<h4 id="保存状态"><a href="#保存状态" class="headerlink" title="保存状态"></a>保存状态</h4><ul>
<li><p>onSaveInstanceState(Bundle savedInstanceState)<br>执行在 onStop 之前</p>
<ul>
<li>back不会触发</li>
<li><h1 id="finish-不会触发"><a href="#finish-不会触发" class="headerlink" title="finish()不会触发"></a>finish()不会触发</h1></li>
<li>home触发</li>
<li>任务列表键会触发</li>
<li>跳转 Activity 会触发</li>
<li>旋转屏幕会触发</li>
<li><p>黑屏会触发</p>
<p>Activity 创建时有一个 bundle 对象, 该对象是上次被系统销毁时在 onSaveInstanceState 保存的参数,</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">static</span> <span class="keyword">final</span> String STATE_SCORE = <span class="string">"playerScore"</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">final</span> String STATE_LEVEL = <span class="string">"playerLevel"</span>;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSaveInstanceState</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">    <span class="comment">// Save the user's current game state</span></div><div class="line">    savedInstanceState.putInt(STATE_SCORE, mCurrentScore);</div><div class="line">    savedInstanceState.putInt(STATE_LEVEL, mCurrentLevel);</div><div class="line"></div><div class="line">    <span class="comment">// Always call the superclass so it can save the view hierarchy state</span></div><div class="line">    <span class="keyword">super</span>.onSaveInstanceState(savedInstanceState);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>注意，自定义的部分在super之前</strong></p>
<blockquote>
<p>使用onSaveInstanceState(Bundle outState, PersistableBundle outPersistentState), 则onSaveInstanceState不会被调用</p>
</blockquote>
</li>
</ul>
</li>
<li><p>onSaveInstanceState(Bundle outState, PersistableBundle outPersistentState)<br>API21 后添加的属性, 能在关机重启后拥有数据恢复的功能, 需要在 manifest 中给 acticity 添加属性</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">android:persistableMode=&quot;persistAcrossReboots&quot;</div></pre></td></tr></table></figure>
<p>  须</p>
<ul>
<li>重写 onCreate(Bundle savedInstanceState, PersistableBundle persistentState),</li>
<li>并不用普通的 onCreate 和 onSaveInstanceState<blockquote>
<p>重写此onSaveInstanceState会导致 onSaveInstanceState 不执行</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h4 id="恢复状态"><a href="#恢复状态" class="headerlink" title="恢复状态"></a>恢复状态</h4><ul>
<li><p>onRestoreInstanceState<br>执行在 onStart 之后, 只有有savedInstanceState时才会调用, 无需判空</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRestoreInstanceState</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">    <span class="comment">// Always call the superclass so it can restore the view hierarchy</span></div><div class="line">    <span class="keyword">super</span>.onRestoreInstanceState(savedInstanceState);</div><div class="line"></div><div class="line">    <span class="comment">// Restore state members from saved instance</span></div><div class="line">    mCurrentScore = savedInstanceState.getInt(STATE_SCORE);</div><div class="line">    mCurrentLevel = savedInstanceState.getInt(STATE_LEVEL);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>onCreate中恢复, 需判空</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState); <span class="comment">// Always call the superclass first</span></div><div class="line"></div><div class="line">    <span class="comment">// Check whether we're recreating a previously destroyed instance</span></div><div class="line">    <span class="keyword">if</span> (savedInstanceState != <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="comment">// Restore value of members from saved state</span></div><div class="line">        mCurrentScore = savedInstanceState.getInt(STATE_SCORE);</div><div class="line">        mCurrentLevel = savedInstanceState.getInt(STATE_LEVEL);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// Probably initialize members with default values for a new instance</span></div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="透明activity-继承AppCompatActivity"><a href="#透明activity-继承AppCompatActivity" class="headerlink" title="透明activity(继承AppCompatActivity)"></a>透明activity(继承AppCompatActivity)</h3><ol>
<li><p>透明color</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;  </div><div class="line">&lt;resources&gt;  </div><div class="line"></div><div class="line">    &lt;color name=&quot;transparent&quot;&gt;#0000&lt;/color&gt;  </div><div class="line"></div><div class="line">&lt;/resources&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>style设置background, style的parent不加会报错: <figure class="highlight plain"><figcaption><span>need to use a Theme.AppCompat theme (or descendant) with this activity.```</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">```</div><div class="line">&lt;style name=&quot;myTransParent&quot; parent=&quot;Theme.AppCompat.Light.NoActionBar&quot;&gt;</div><div class="line">    &lt;item name =&quot;android:windowBackground&quot;&gt;@color/transParent&lt;/item&gt;</div><div class="line">    &lt;item name =&quot;android:windowNoTitle&quot;&gt;true&lt;/item&gt;</div><div class="line">    &lt;item name =&quot;android:windowIsTranslucent&quot;&gt;true&lt;/item&gt;</div><div class="line">    &lt;item name =&quot;android:colorBackgroundCacheHint&quot;&gt;@null&lt;/item&gt;</div><div class="line">    &lt;item name =&quot;android:windowAnimationStyle&quot;&gt;@android:style/Animation.Translucent&lt;/item&gt;</div><div class="line">    &lt;item name =&quot;android:statusBarColor&quot;&gt;@color/transParent&lt;/item&gt;</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure></p>
</li>
<li><p>清单设置 activity 的 theme</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">android:theme=&quot;@style/myTransparent&quot;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>ActivityA 打开透明ActivityB<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">onPause</div><div class="line">onCreate --B</div><div class="line">onStart --B</div><div class="line">onResume --B</div></pre></td></tr></table></figure></p>
<p>透明ActivityB返回ActivityA<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">onPause --B</div><div class="line">onResume</div><div class="line">onStop --B</div><div class="line">onDestroy --B</div></pre></td></tr></table></figure></p>
<h3 id="启动模式"><a href="#启动模式" class="headerlink" title="启动模式"></a>启动模式</h3><p>A组件运行在A应用, A组件调用系统的照相组件, 虽然不在一个应用, 但是安卓运行跨应用组件, 虽然两者不在一个进程, 但是可以通过Task来实现, Task可以理解为实现一个功能而负责管理所有用到的 Activity实例的栈</p>
<h4 id="standard"><a href="#standard" class="headerlink" title="standard"></a>standard</h4><p>默认, 先进后出</p>
<h4 id="singleTop"><a href="#singleTop" class="headerlink" title="singleTop"></a>singleTop</h4><p>栈顶不重复, 唯一<br>如果要开启的 activity 已经在栈顶存在, 就不会创建新的实例, 而去调用 onNewIntent().<br>如果栈顶没有, 则创建新的实例<br>比如 通知栏的通知点击打开activity, 用singleTop可以避免重复创建<br><strong>快速点击不能只依赖这个, 不靠谱, 第一个栈实例可能还没入栈,就创建了第二个然后和第一个一起入栈了, 建议对快速点击另作判断</strong></p>
<h4 id="singleTask"><a href="#singleTask" class="headerlink" title="singleTask"></a>singleTask</h4><p>栈内不重复, 干掉头上的其他activity<br>如果要开启的activity已经在栈内存在, 就不会创建新的栈和新的实例, 而去调用 onNewIntent(), 并且清空它上面的所有activity<br>比如 主界面, 保证主界面上面没有activity</p>
<h4 id="singleInstance"><a href="#singleInstance" class="headerlink" title="singleInstance"></a>singleInstance</h4><p>单一实例, 单一栈, 栈里只有自己<br>谨慎使用<br>如果要开启的activity已经在进程中存在, 就不会创建新的实例, 而去调用 onNewIntent().<br>比如 呼叫来电界面</p>
<h3 id="指定启动模式"><a href="#指定启动模式" class="headerlink" title="指定启动模式"></a>指定启动模式</h3><h4 id="manifest指定"><a href="#manifest指定" class="headerlink" title="manifest指定"></a>manifest指定</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;activity android:name=&quot;.SecondActivity&quot;</div><div class="line">            android:launchMode=&quot;singleTask&quot;/&gt;</div></pre></td></tr></table></figure>
<h4 id="代码指定"><a href="#代码指定" class="headerlink" title="代码指定"></a>代码指定</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Intent intent = <span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>, SecondActivity.class);</div><div class="line">               <span class="comment">//通过 intent.addFlags 设置</span></div><div class="line">               intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</div><div class="line">               startActivity(intent);</div></pre></td></tr></table></figure>
<ul>
<li>对比<ul>
<li>代码指定优先于 manifest</li>
<li>manifest无法设定singleInstance模式</li>
</ul>
</li>
<li>Intent.FLAG_:<ul>
<li>FLAG_ACTIVITY_NEW_TASK = 开新栈, 多用在service和Application, 因为他俩没有栈</li>
<li>FLAG_ACTIVITY_SINGLE_TOP = singleTop</li>
<li>FLAG_ACTIVITY_CLEAR_TOP = singleTask</li>
<li>FLAG_ACTIVITY_NO_HISTORY 启动完其他的后, 自己消失</li>
</ul>
</li>
<li><p>LaunchMode + StartActivityForResult 在 5.0 分水岭</p>
<ul>
<li><strong>5.0 之前可能不回调</strong></li>
<li>5.0 后全部有回调<h4 id="adb-查看任务栈"><a href="#adb-查看任务栈" class="headerlink" title="adb 查看任务栈"></a>adb 查看任务栈</h4></li>
</ul>
<ol>
<li><p>运行</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb shell dumpsys activity</div></pre></td></tr></table></figure>
</li>
<li><p>搜 Recent tasks 查看已经存在的任务栈</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Recent tasks:</div><div class="line">   * Recent #0: TaskRecord&#123;5bd8fdd #749 A=com.taskaffinity U=0 sz=1&#125;</div><div class="line">   * Recent #1: TaskRecord&#123;a972e43 #748 A=com.activityfull U=0 sz=1&#125;</div><div class="line">   * Recent #2: TaskRecord&#123;7a2180c #664 I=com.android.launcher3/.Launcher U=0 sz=1&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>搜 Running activities (most recent first)查看activity</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Running activities (most recent first):</div><div class="line">   TaskRecord&#123;25d22cd #684 A=com.activityfull U=0 sz=2&#125;</div><div class="line">     Run #1: ActivityRecord&#123;8e55d0b u0 com.activityfull/.SecondActivity t684&#125;</div><div class="line">     Run #0: ActivityRecord&#123;d26b857 u0 com.activityfull/.MainActivity t684&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>栈的唯一标号是#682, sz 表示栈内有几个组件, 栈顶的是 SecondActivity,</p>
<ol>
<li>Recent tasks查看手机程序的任务栈, != 应用数(一个应用可能包含多个栈), 更不是进程数<br>任务栈数 = 手机任务列表里显示的数量 + com.android.launcher + com.android.systemui <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ACTIVITY MANAGER RECENT TASKS (dumpsys activity recents)</div><div class="line">  Recent tasks:</div><div class="line">  * Recent #0: TaskRecord&#123;42a273f #682 A=com.activityfull U=0 sz=1&#125;</div><div class="line">  * Recent #1: TaskRecord&#123;7a2180c #664 I=com.android.launcher3/.Launcher U=0 sz=1&#125;</div><div class="line">  * Recent #2: TaskRecord&#123;8a01555 #667 A=com.android.systemui U=0 sz=1&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
<h5 id="android-exported-”true”"><a href="#android-exported-”true”" class="headerlink" title="android:exported=”true”"></a>android:exported=”true”</h5><p>允许其他app打开这个activity</p>
<h4 id="taskAffinity-allowTaskReparenting"><a href="#taskAffinity-allowTaskReparenting" class="headerlink" title="taskAffinity + allowTaskReparenting"></a>taskAffinity + allowTaskReparenting</h4><ul>
<li>taskAffinity<br>设置activity进入指定完整栈名的栈,一般和singleTask一起使用<ul>
<li><em>Application中设置</em>(推荐activity设置), 不设定则默认包名, 设定了内部 Activity和 Application一致</li>
<li>Activity 中设置, 如果指定的任务栈不存在, 那么会自己新开一个指定包名的任务栈</li>
</ul>
</li>
<li>allowTaskReparenting<br>是否依附与开启这个 Activity 的任务栈</li>
<li><p>举例:</p>
<ul>
<li>APP1 内有 activity1, activity2; APP2内有 activity3 和 activity4, 当 APP1 的 activity1 在 APP1 内打开这个 APP2 的 activity4 时,</li>
<li><p>1.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;activity android:name=&quot;.FourActivity&quot;</div><div class="line">         android:exported=&quot;true&quot;</div><div class="line">         /&gt;</div></pre></td></tr></table></figure>
<p>a. 只有 APP1 的任务栈打开, 存放的是 activity1 和 activity4;<br>b. 按home, 点开 APP1 看到的是 activity4, 按back, 看到activity1, 按back, 退出<br>c. 按home, 点开 APP2 看到的是 activity3, 按back, 退出</p>
</li>
<li><p>2.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;activity android:name=&quot;.FourActivity&quot;</div><div class="line">           android:exported=&quot;true&quot;</div><div class="line">           android:allowTaskReparenting=&quot;true&quot;</div><div class="line">           /&gt;</div></pre></td></tr></table></figure>
<p>a. 只有 APP1 的任务栈打开, 存放的是 activity1 和 activity4;<br>b. 按home, 点开 APP1 看到的是 activity1,<br>c. 按home, 点开 APP2 看到的是 activity4, 按back, 看到activity3, 按back, 退出</p>
</li>
<li><p>3.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;activity android:name=&quot;.FourActivity&quot;</div><div class="line">           android:exported=&quot;true&quot;</div><div class="line">           android:allowTaskReparenting=&quot;true&quot;</div><div class="line">           android:launchMode=&quot;singleTask&quot;</div><div class="line">           /&gt;</div></pre></td></tr></table></figure>
<p>a. APP1 任务栈存放 activity1, APP2 的任务栈存放activity4<br>b. 按home, 点开APP1 看到的是 activity1<br>c. 按home, 点开APP2 看到的是 activity4, 按back退出</p>
</li>
</ul>
</li>
</ul>
<h4 id="Intent-Flag"><a href="#Intent-Flag" class="headerlink" title="Intent.Flag"></a>Intent.Flag</h4><ul>
<li>Intent.FLAG_ACTIVITY_NEW_TASK<br>单独使用无效果, 需和 taskAffinity 一起使用, 当使用 Intent.FLAG_ACTIVITY_NEW_TASK + taskAffinity 指定非包名的任务站名 == android:launchMode=”singleInstance”</li>
<li>Intent.FLAG_ACTIVITY_SINGLE_TOP == android:launchMode=”singleTop”</li>
<li>Intent.FLAG_ACTIVITY_CLEAR_TOP 与 android:launchMode=”singleTask”类似, 但是如果栈顶是自身, 会毁旧建新, 重走生命周期, 而不是 onNewIntent</li>
<li>Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS<br>具有这个标记的Activity不会出现在Activity的历史列表中.<br>他等同于在xml里面设定 android:excludeFromRecents=”true” 。</li>
</ul>
<h3 id="打开其他APP-Link"><a href="#打开其他APP-Link" class="headerlink" title="打开其他APP Link"></a>打开其他APP <a href="http://www.jianshu.com/p/42ae7066f8f3" target="_blank" rel="external">Link</a></h3><h4 id="通过-APP-打开一个-APP"><a href="#通过-APP-打开一个-APP" class="headerlink" title="通过 APP 打开一个 APP"></a>通过 APP 打开一个 APP</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">PackageManager packageManager = getPackageManager();</div><div class="line">    if (checkPackInfo(packname)) &#123;</div><div class="line">        Intent intent = packageManager.getLaunchIntentForPackage(packname);</div><div class="line">        startActivity(intent);</div><div class="line">    &#125; else &#123;</div><div class="line">        Toast.makeText(MainActivity.this, &quot;没有安装&quot; + packname, 1).show();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 检查包是否存在</div><div class="line">     *</div><div class="line">     * @param packname</div><div class="line">     * @return</div><div class="line">     */</div><div class="line">    private boolean checkPackInfo(String packname) &#123;</div><div class="line">        PackageInfo packageInfo = null;</div><div class="line">        try &#123;</div><div class="line">            packageInfo = getPackageManager().getPackageInfo(packname, 0);</div><div class="line">        &#125; catch (PackageManager.NameNotFoundException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        return packageInfo != null;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h4 id="打开其他APP的Actvitiy"><a href="#打开其他APP的Actvitiy" class="headerlink" title="打开其他APP的Actvitiy"></a>打开其他APP的Actvitiy</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Intent intent = new Intent();</div><div class="line">    //第一种方式</div><div class="line">    ComponentName cn = new ComponentName(&quot;com.example.fm&quot;, &quot;com.example.fm.MainFragmentActivity&quot;);</div><div class="line">    try &#123;</div><div class="line">        intent.setComponent(cn);</div><div class="line">        //第二种方式</div><div class="line">        //intent.setClassName(&quot;com.example.fm&quot;, &quot;com.example.fm.MainFragmentActivity&quot;);</div><div class="line">        intent.putExtra(&quot;test&quot;, &quot;intent1&quot;);</div><div class="line">        startActivity(intent);</div><div class="line">    &#125; catch (Exception e) &#123;</div><div class="line">        //TODO  可以在这里提示用户没有安装应用或找不到指定Activity，或者是做其他的操作</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<ol>
<li><p>需要将目标Activity的android:exported=”true”属性在所属应用AndroidMainfest里设置为true，意思是当前Activity可以被外部应用访问，否则会报下面的错误</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Caused by: java.lang.SecurityException: Permission Denial: starting  Intent</div><div class="line">&#123; cmp=com.example.fm/.MainFragmentActivity (has extras) &#125; from ProcessRecord</div><div class="line">&#123;39282a97 11545:com.xing.toolbardemo1/u0a71&#125;  (pid=11545,     uid=10071) not exported from uid 10067</div></pre></td></tr></table></figure>
</li>
<li><p>需要在当前应用的AndroidMainfest里也声明目标Activity，否则会报下面的错误<br>（5.0以后好像不会有这个错，我用的了两个5.0一下的测试机都报错了）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Caused by: android.content.ActivityNotFoundException: Unable to find</div><div class="line"> explicit activity class &#123;com.example.fm/com.example.fm.MainFragmentActivity&#125;;</div><div class="line"> have you declared this activity in your AndroidManifest.xml?</div></pre></td></tr></table></figure>
<p>在清单文件里面添加目标Activity就成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;activity android:name=&quot;com.example.fm.MainFragmentActivity&quot;&gt;&lt;/activity&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="参数传递"><a href="#参数传递" class="headerlink" title="参数传递"></a>参数传递</h3><p>普通数据直接在Intent中添加bundle.如果需要传递类, 因为 Activity 和 Fragment无法直接传递类, 所以需要序列化, 序列化的方式分为 java 自带的 Serializable 或者 Android 自带的 Parcelable</p>
<ul>
<li><p>Serializable<br>java自带的, 基于反射实现, 将对象存入字节流, 序列化的过程需要进行大量I/O操作, 速度较慢, 产生大量临时的对象, 容易触发GC</p>
</li>
<li><p>Parcelable<br>android提供的, 为了IPC(进程间通信机制)而设计 parcel, 原理是将对象分解, 分解后的每一部分Intent都可以直接使用自己实现了封送和解封不需要反射, 数据也存在Native内存, 但是它无法很好的持久化保存数据,</p>
</li>
<li>对比:<br><img src="https://raw.githubusercontent.com/sunxlfred/RES/b761a9c324ffc934e11d4132df1a18d2387e6065/Serializable%26Parcelable.png" alt=""></li>
</ul>
<h3 id="onNewIntent"><a href="#onNewIntent" class="headerlink" title="onNewIntent"></a>onNewIntent</h3><p>singleTask等模式, 如果 Activity 还在任务栈, 且没被销毁, 则会调用 onNewIntent, 否则还是走onCreate.<br>onNewIntent(intent)中的intent是此次的intent, 但是getIntent 是上一次的intent.</p>
<blockquote>
<p>参考</p>
<ul>
<li><a href="http://www.voidcn.com/article/p-wulaqhzu-nq.html" target="_blank" rel="external">android onUserLeaveHint和onUserInteraction</a></li>
<li><a href="https://developer.android.com/training/basics/activity-lifecycle/recreating.html?hl=zh-cn" target="_blank" rel="external">Google | 重新创建 Activity</a></li>
<li><a href="http://www.jianshu.com/p/2a9fcf3c11e4" target="_blank" rel="external">简书 | 我打赌你一定没搞明白的Activity启动模式</a></li>
<li><a href="http://www.jianshu.com/p/42ae7066f8f3" target="_blank" rel="external">简书 | Android通过App启动另一个APP
</a></li>
<li><a href="http://www.jianshu.com/p/c7889a533050" target="_blank" rel="external">简书} Android-Activity所应该了解的大概就这样。（中）</a></li>
<li><a href="http://www.jianshu.com/p/4ed47560c5e4" target="_blank" rel="external">Android中onNewIntent()的用法</a></li>
</ul>
</blockquote>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Android/" rel="tag"># Android</a>
          
            <a href="/tags/Activity/" rel="tag"># Activity</a>
          
            <a href="/tags/Activity栈/" rel="tag"># Activity栈</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/08/25/Day10-idea,maven,spring boot,vim/" rel="next" title="Day10 - 尝试搭自己的服务器">
                <i class="fa fa-chevron-left"></i> Day10 - 尝试搭自己的服务器
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/09/04/Day12-Java/" rel="prev" title="Day12 - Java">
                Day12 - Java <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://avatars2.githubusercontent.com/u/9950351?s=460&v=4"
                alt="FredSun" />
            
              <p class="site-author-name" itemprop="name">FredSun</p>
              <p class="site-description motion-element" itemprop="description">上进的懒狗</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">27</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/sunxlfred" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-globe"></i>GitHub</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#生命周期"><span class="nav-number">1.</span> <span class="nav-text">生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#处理广播-在onStart和onStop-onResume和onPause易触发并且可能只是暂时不能执行-被透明activity挡住"><span class="nav-number">1.1.</span> <span class="nav-text">处理广播, 在onStart和onStop, onResume和onPause易触发并且可能只是暂时不能执行(被透明activity挡住)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#跳转B前操作数据库-并且B需要数据库-在onPause"><span class="nav-number">1.2.</span> <span class="nav-text">跳转B前操作数据库, 并且B需要数据库, 在onPause,</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#黑屏-按home-按任务列表生命周期"><span class="nav-number">1.3.</span> <span class="nav-text">黑屏/按home/按任务列表生命周期:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#横竖屏切换生命周期-此时开-alertDialog-Builder-格式的dialog-生命周期不影响"><span class="nav-number">1.4.</span> <span class="nav-text">横竖屏切换生命周期,此时开 alertDialog.Builder 格式的dialog, 生命周期不影响</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity-是否运行"><span class="nav-number">2.</span> <span class="nav-text">Activity 是否运行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#onUserLeaveHint-和-onUserInteraction"><span class="nav-number">3.</span> <span class="nav-text">onUserLeaveHint 和 onUserInteraction</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#临时状态保存-–-onSaveInstanceState-和-onRestoreInstanceState"><span class="nav-number">4.</span> <span class="nav-text">临时状态保存 – onSaveInstanceState 和 onRestoreInstanceState</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#保存状态"><span class="nav-number">4.1.</span> <span class="nav-text">保存状态</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#finish-不会触发"><span class="nav-number"></span> <span class="nav-text">finish()不会触发</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#恢复状态"><span class="nav-number">0.1.</span> <span class="nav-text">恢复状态</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#透明activity-继承AppCompatActivity"><span class="nav-number">1.</span> <span class="nav-text">透明activity(继承AppCompatActivity)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#启动模式"><span class="nav-number">2.</span> <span class="nav-text">启动模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#standard"><span class="nav-number">2.1.</span> <span class="nav-text">standard</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#singleTop"><span class="nav-number">2.2.</span> <span class="nav-text">singleTop</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#singleTask"><span class="nav-number">2.3.</span> <span class="nav-text">singleTask</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#singleInstance"><span class="nav-number">2.4.</span> <span class="nav-text">singleInstance</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#指定启动模式"><span class="nav-number">3.</span> <span class="nav-text">指定启动模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#manifest指定"><span class="nav-number">3.1.</span> <span class="nav-text">manifest指定</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#代码指定"><span class="nav-number">3.2.</span> <span class="nav-text">代码指定</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#adb-查看任务栈"><span class="nav-number">3.3.</span> <span class="nav-text">adb 查看任务栈</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#android-exported-”true”"><span class="nav-number">3.3.1.</span> <span class="nav-text">android:exported=”true”</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#taskAffinity-allowTaskReparenting"><span class="nav-number">3.4.</span> <span class="nav-text">taskAffinity + allowTaskReparenting</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Intent-Flag"><span class="nav-number">3.5.</span> <span class="nav-text">Intent.Flag</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#打开其他APP-Link"><span class="nav-number">4.</span> <span class="nav-text">打开其他APP Link</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#通过-APP-打开一个-APP"><span class="nav-number">4.1.</span> <span class="nav-text">通过 APP 打开一个 APP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#打开其他APP的Actvitiy"><span class="nav-number">4.2.</span> <span class="nav-text">打开其他APP的Actvitiy</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参数传递"><span class="nav-number">5.</span> <span class="nav-text">参数传递</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#onNewIntent"><span class="nav-number">6.</span> <span class="nav-text">onNewIntent</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">FredSun</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  

  

  

</body>
</html>
